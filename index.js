var c=Object.defineProperty;var l=(o,e,a)=>e in o?c(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var s=(o,e,a)=>(l(o,typeof e!="symbol"?e+"":e,a),a);import{W as g,S as p,P as w,C as m,V as M,G as f,M as v,a as b,T as u,F as k,b as y,c as T,A as C,D as L}from"./vendor.js";const D=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const t of i)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function a(i){const t={};return i.integrity&&(t.integrity=i.integrity),i.referrerpolicy&&(t.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?t.credentials="include":i.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function r(i){if(i.ep)return;i.ep=!0;const t=a(i);fetch(i.href,t)}};D();class q{constructor(e=60,a=1.333,r=1,i=1e3){s(this,"aspectRatio");s(this,"fov");s(this,"znear");s(this,"zfar");s(this,"renderer");s(this,"scene");s(this,"camera");s(this,"clock");this.fov=e,this.aspectRatio=a,this.znear=r,this.zfar=i,this.renderer=new g,this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.resize(),window.addEventListener("resize",()=>{this.resize()},!1),window.addEventListener("mousedown",t=>{this.onMouseDown(t)}),window.addEventListener("mouseup",t=>{this.onMouseUp(t)}),window.addEventListener("mousemove",t=>{this.onMouseMove(t)}),window.addEventListener("keydown",t=>{this.onKeyDown(t)}),window.addEventListener("keyup",t=>{this.onKeyUp(t)}),this.scene=new p,this.camera=new w(this.fov,this.aspectRatio,this.znear,this.zfar),this.clock=new m}start(){this.createScene(),this.mainLoop()}mainLoop(){this.update(this.clock.getDelta()),this.renderer.render(this.scene,this.camera),window.requestAnimationFrame(()=>this.mainLoop())}resize(){this.renderer.setSize(window.innerWidth,window.innerHeight);var e=new M;this.renderer.getViewport(e);var a=window.innerWidth/window.innerHeight;this.aspectRatio>a?this.renderer.setViewport(0,(window.innerHeight-window.innerWidth/this.aspectRatio)/2,window.innerWidth,window.innerWidth/this.aspectRatio):this.renderer.setViewport((window.innerWidth-window.innerHeight*this.aspectRatio)/2,0,window.innerHeight*this.aspectRatio,window.innerHeight)}onMouseDown(e){}onMouseUp(e){}onMouseMove(e){}onKeyDown(e){}onKeyUp(e){}}class S extends f{constructor(){super();s(this,"earthMesh");s(this,"earthMaterial");this.earthMesh=new v,this.earthMaterial=new b}initialize(){this.earthMaterial.map=new u().load("./data/earth-2k.png");var e=[];e.push(-.5,-.5,0),e.push(.5,-.5,0),e.push(.5,.5,0),e.push(-.5,.5,0);var a=[];a.push(0,1,2),a.push(0,2,3),this.earthMesh.geometry.setAttribute("position",new k(e,3)),this.earthMesh.geometry.setIndex(a),this.add(this.earthMesh)}update(e){}}class x{constructor(e){s(this,"date");s(this,"longitude");s(this,"latitude");s(this,"magnitude");this.date=new Date,this.date.setUTCFullYear(parseInt(e.substring(12,16))),this.date.setUTCMonth(parseInt(e.substring(17,19))),this.date.setUTCDate(parseInt(e.substring(20,22))),this.date.setUTCHours(parseInt(e.substring(24,26))),this.date.setUTCMinutes(parseInt(e.substring(27,29))),this.date.setUTCSeconds(parseFloat(e.substring(30,35))),this.longitude=parseFloat(e.substring(44,52)),this.latitude=parseFloat(e.substring(37,44)),this.magnitude=parseFloat(e.substring(66,70))}}class z{constructor(e){s(this,"earthquakes");s(this,"loaded");s(this,"maxMagnitude");s(this,"minMagnitude");this.earthquakes=[],this.loaded=!1,this.maxMagnitude=0,this.minMagnitude=1/0;var a=new y;a.load(e,r=>{var i=r.toString().split(`
`);i.forEach(t=>{if(t.length>30){var n=new x(t);this.earthquakes.push(n),n.magnitude>this.maxMagnitude?this.maxMagnitude=n.magnitude:n.magnitude<this.minMagnitude&&(this.minMagnitude=n.magnitude)}}),this.loaded=!0})}findMostRecentQuake(e){for(var a=e.getTime(),r=0,i=this.earthquakes.length-1;r<i-1;){var t=Math.floor((r+i)/2);this.earthquakes[t].date.getTime()>a?i=t-1:r=t}return r==i||this.earthquakes[i].date.getTime()>a?r:i}getMaxTime(){return this.earthquakes[this.earthquakes.length-1].date.getTime()}getMinTime(){return this.earthquakes[0].date.getTime()}}class U extends q{constructor(){super(60,1920/1080,.1,50);s(this,"earth");s(this,"gui");s(this,"earthquakeDB");s(this,"currentTime");s(this,"date");s(this,"viewMode");s(this,"playbackSpeed");s(this,"debugMode");this.gui=new T,this.earth=new S,this.earthquakeDB=new z("./data/earthquakes.txt"),this.currentTime=1/0,this.date="",this.viewMode="Map",this.playbackSpeed=.5,this.debugMode=!1}createScene(){this.camera.position.set(0,0,3.5),this.camera.lookAt(0,0,0),this.camera.up.set(0,1,0);var e=new C("white",.25);this.scene.add(e);var a=new L("white",.6);a.position.set(10,10,10),this.scene.add(a),this.scene.background=new u().load("./data/iss006e40544.png"),this.earth.initialize(),this.scene.add(this.earth);var r=this.gui.addFolder("Earthquake Controls"),i=r.add(this,"date");i.name("Current Date"),i.listen();var t=r.add(this,"viewMode",{Map:"Map",Globe:"Globe"});t.name("View Mode"),t.onChange(h=>{console.log("View mode changed to: "+h)});var n=r.add(this,"playbackSpeed",0,1);n.name("Playback Speed"),n.onChange(h=>{console.log("Playback speed changed to: "+h)});var d=r.add(this,"debugMode");d.name("Debug Mode"),d.onChange(h=>{console.log("Debug mode changed to: "+h)}),this.gui.width=300,r.open()}update(e){if(!this.earthquakeDB.loaded)return;const a=3e7*1e3;this.currentTime+=a*this.playbackSpeed*e,this.currentTime>this.earthquakeDB.getMaxTime()&&(this.currentTime=this.earthquakeDB.getMinTime());var r=new Date;r.setTime(this.currentTime),this.date=r.getUTCMonth()+"/"+r.getUTCDate()+"/"+r.getUTCFullYear()}}var E=new U;E.start();
