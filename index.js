var l=Object.defineProperty;var c=(o,e,i)=>e in o?l(o,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[e]=i;var t=(o,e,i)=>(c(o,typeof e!="symbol"?e+"":e,i),i);import{W as g,S as p,P as m,C as w,V as M,G as f,M as v,a as b,b as k,T as u,L as D,F as x,c as d,d as y,e as T,f as L,D as C}from"./vendor.js";const q=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function i(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=i(a);fetch(a.href,s)}};q();class I{constructor(e=60,i=1.333,r=1,a=1e3){t(this,"aspectRatio");t(this,"fov");t(this,"znear");t(this,"zfar");t(this,"renderer");t(this,"scene");t(this,"camera");t(this,"clock");this.fov=e,this.aspectRatio=i,this.znear=r,this.zfar=a,this.renderer=new g,this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.resize(),window.addEventListener("resize",()=>{this.resize()},!1),window.addEventListener("mousedown",s=>{this.onMouseDown(s)}),window.addEventListener("mouseup",s=>{this.onMouseUp(s)}),window.addEventListener("mousemove",s=>{this.onMouseMove(s)}),window.addEventListener("keydown",s=>{this.onKeyDown(s)}),window.addEventListener("keyup",s=>{this.onKeyUp(s)}),this.scene=new p,this.camera=new m(this.fov,this.aspectRatio,this.znear,this.zfar),this.clock=new w}start(){this.createScene(),this.mainLoop()}mainLoop(){this.update(this.clock.getDelta()),this.renderer.render(this.scene,this.camera),window.requestAnimationFrame(()=>this.mainLoop())}resize(){this.renderer.setSize(window.innerWidth,window.innerHeight);var e=new M;this.renderer.getViewport(e);var i=window.innerWidth/window.innerHeight;this.aspectRatio>i?this.renderer.setViewport(0,(window.innerHeight-window.innerWidth/this.aspectRatio)/2,window.innerWidth,window.innerWidth/this.aspectRatio):this.renderer.setViewport((window.innerWidth-window.innerHeight*this.aspectRatio)/2,0,window.innerHeight*this.aspectRatio,window.innerHeight)}onMouseDown(e){}onMouseUp(e){}onMouseMove(e){}onKeyDown(e){}onKeyUp(e){}}class S extends f{constructor(){super();t(this,"earthMesh");t(this,"earthMaterial");t(this,"debugMaterial");this.earthMesh=new v,this.earthMaterial=new b,this.debugMaterial=new k}initialize(){this.earthMaterial.map=new u().load("./data/earth-2k.png"),this.earthMaterial.map.minFilter=D,this.debugMaterial.wireframe=!0;var e=[];e.push(-.5,-.5,0),e.push(.5,-.5,0),e.push(.5,.5,0),e.push(-.5,.5,0);var i=[];i.push(0,1,2),i.push(0,2,3),this.earthMesh.geometry.setAttribute("position",new x(e,3)),this.earthMesh.geometry.setIndex(i),this.add(this.earthMesh)}update(e){}toggleDebugMode(e){e?this.earthMesh.material=this.debugMaterial:this.earthMesh.material=this.earthMaterial}convertLatLongToPlane(e,i){return new d}convertLatLongToSphere(e,i){return new d}}class U{constructor(e){t(this,"date");t(this,"longitude");t(this,"latitude");t(this,"magnitude");this.date=new Date,this.date.setUTCFullYear(parseInt(e.substring(12,16))),this.date.setUTCMonth(parseInt(e.substring(17,19))),this.date.setUTCDate(parseInt(e.substring(20,22))),this.date.setUTCHours(parseInt(e.substring(24,26))),this.date.setUTCMinutes(parseInt(e.substring(27,29))),this.date.setUTCSeconds(parseFloat(e.substring(30,35))),this.longitude=parseFloat(e.substring(44,52)),this.latitude=parseFloat(e.substring(37,44)),this.magnitude=parseFloat(e.substring(66,70))}}class z{constructor(e){t(this,"earthquakes");t(this,"loaded");t(this,"maxMagnitude");t(this,"minMagnitude");t(this,"nextIndex");this.earthquakes=[],this.loaded=!1,this.maxMagnitude=0,this.minMagnitude=1/0,this.nextIndex=0;var i=new y;i.load(e,r=>{var a=r.toString().split(`
`);a.forEach(s=>{if(s.length>30){var n=new U(s);this.earthquakes.push(n),n.magnitude>this.maxMagnitude?this.maxMagnitude=n.magnitude:n.magnitude<this.minMagnitude&&(this.minMagnitude=n.magnitude)}}),this.loaded=!0})}reset(){this.nextIndex=0}getNextQuake(e){for(var i=e.getTime();this.nextIndex<this.earthquakes.length;)return this.earthquakes[this.nextIndex].date.getTime()<i?(this.nextIndex++,this.earthquakes[this.nextIndex-1]):null;return null}getMaxTime(){return this.earthquakes[this.earthquakes.length-1].date.getTime()}getMinTime(){return this.earthquakes[0].date.getTime()}}class F extends I{constructor(){super(60,1920/1080,.1,50);t(this,"earth");t(this,"gui");t(this,"earthquakeDB");t(this,"currentTime");t(this,"mouseDrag");t(this,"mouseVector");t(this,"date");t(this,"viewMode");t(this,"playbackSpeed");t(this,"debugMode");this.gui=new T,this.earth=new S,this.earthquakeDB=new z("./data/earthquakes.txt"),this.currentTime=1/0,this.mouseDrag=!1,this.mouseVector=new L,this.date="",this.viewMode="Map",this.playbackSpeed=.5,this.debugMode=!1}createScene(){this.camera.position.set(0,0,3.25),this.camera.lookAt(0,0,0),this.camera.up.set(0,1,0);var e=new C("white",1.5);e.position.set(10,10,15),this.scene.add(e),this.scene.background=new u().load("./data/stars.png"),this.earth.initialize(),this.scene.add(this.earth);var i=this.gui.addFolder("Earthquake Controls"),r=i.add(this,"date");r.name("Current Date"),r.listen();var a=i.add(this,"viewMode",{Map:"Map",Globe:"Globe"});a.name("View Mode"),a.onChange(h=>{});var s=i.add(this,"playbackSpeed",0,1);s.name("Playback Speed");var n=i.add(this,"debugMode");n.name("Debug Mode"),n.onChange(h=>{this.toggleDebugMode(h)}),this.gui.width=300,i.open()}update(e){if(!this.earthquakeDB.loaded)return;const i=3e10;this.currentTime+=i*this.playbackSpeed*e,this.currentTime>this.earthquakeDB.getMaxTime()&&(this.currentTime=this.earthquakeDB.getMinTime(),this.earthquakeDB.reset());var r=new Date;r.setTime(this.currentTime),this.date=r.getUTCMonth()+"/"+r.getUTCDate()+"/"+r.getUTCFullYear()}toggleDebugMode(e){this.earth.toggleDebugMode(e)}onMouseDown(e){this.mouseDrag=!0}onMouseUp(e){this.mouseDrag=!1}onMouseMove(e){this.mouseDrag,this.mouseVector.set(e.x,e.y)}}var E=new F;E.start();
